<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Ka-chung</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="ZoomersClient.Client.styles.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans&display=swap" rel="stylesheet">
    <script src="_content/Blazor.Extensions.Canvas/blazor.extensions.canvas.js"></script>
    <script src="https://unpkg.com/floating.js"></script>
    <script>
        window.FloatItem = (item) => {
            floating({
                content: item,
                number: 1,
                duration: 8,
                repeat: 1
            });
        }
        window.PlayAudioFile = (src) => {
            var audio = document.getElementById('player');
            if (audio != null) {
                var audioSource = document.getElementById('playerSource');
                if (audioSource != null) {
                    audioSource.src = src;
                    audio.load();
                    audio.play();
                }
            }
        }
        window.PlayMusic = (src) => {
            var audio = document.getElementById('music');
            if (audio != null) {
                audio.volume = 0.3;
                var audioSource = document.getElementById('musicSource');
                if (audioSource != null) {
                    audioSource.src = src;
                    audio.load();
                    audio.play();
                }
            }
        }
        //https://damienbod.com/2018/05/13/uploading-and-sending-image-messages-with-asp-net-core-signalr/
        // https://stackoverflow.com/questions/45078471/turning-canvas-todataurl-domstring-url-into-a-blob
        window.DataURLtoBlob = (dataurl) => {
            // console.log(dataurl);
            var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
                bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
            while(n--){
                u8arr[n] = bstr.charCodeAt(n);
            }
            var blob = new Blob([u8arr], {type:mime});
            console.log(blob);
            return blob;
        }
    </script>
</head>

<body>
    <div id="app">
        <div id="app-splash">
            <div class="container">
                <div class="row h-100 align-items-center">
                    <div class="col text-center">
                        <div class="lds-ellipsis mt-4"><div></div><div></div><div></div><div></div></div>
                        <br />
                        Loading
                    </div>
                </div>                
            </div>
        </div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>

    <audio id="player">
        <source id="playerSource" src="" />
    </audio>

    <audio id="music" volume="0.3">
        <source id="musicSource" src="" />
    </audio>

    <script src="_framework/blazor.webassembly.js"></script>
</body>

</html>
